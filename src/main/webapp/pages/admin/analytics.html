<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Analytics - Shopping Cart System</title>
    <link rel="stylesheet" href="../../css/admin-layout.css">
    <link rel="stylesheet" href="../../css/admin-dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        .analytics-container {
            padding: 30px;
            background-color: #ecf0f1;
        }

        /* ==================== FILTER PANEL ==================== */
        .filter-panel {
            background-color: var(--white);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .filter-panel h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--text-color);
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 6px;
            color: var(--text-color);
        }

        .filter-group input,
        .filter-group select {
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 13px;
            background-color: var(--white);
            color: var(--text-color);
        }

        .filter-group input:focus,
        .filter-group select:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.3);
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .filter-buttons button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-apply {
            background-color: var(--secondary-color);
            color: var(--white);
        }

        .btn-apply:hover {
            background-color: #2980b9;
        }

        .btn-reset {
            background-color: var(--light-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }

        .btn-reset:hover {
            background-color: var(--border-color);
        }

        /* ==================== ANALYTICS SECTIONS ==================== */
        .analytics-section {
            background-color: var(--white);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light-bg);
            flex-wrap: wrap;
            gap: 10px;
        }

        .section-header h3 {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-color);
        }

        .section-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .section-actions button {
            padding: 8px 15px;
            font-size: 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: var(--light-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }

        .section-actions button:hover {
            background-color: var(--secondary-color);
            color: var(--white);
            border-color: var(--secondary-color);
        }

        /* ==================== CHARTS ==================== */
        .chart-container {
            position: relative;
            height: 350px;
            margin: 20px 0;
        }

        .two-column-charts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .chart-box {
            background-color: var(--light-bg);
            padding: 15px;
            border-radius: 6px;
            position: relative;
            height: 300px;
        }

        /* ==================== STATS GRID ==================== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-box {
            background: linear-gradient(135deg, var(--secondary-color) 0%, #2980b9 100%);
            color: var(--white);
            padding: 15px;
            border-radius: 6px;
            text-align: center;
        }

        .stat-box.success {
            background: linear-gradient(135deg, var(--success-color) 0%, #229954 100%);
        }

        .stat-box.warning {
            background: linear-gradient(135deg, var(--warning-color) 0%, #d68910 100%);
        }

        .stat-box.danger {
            background: linear-gradient(135deg, var(--danger-color) 0%, #a93226 100%);
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 5px;
            text-transform: uppercase;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
        }

        .stat-change {
            font-size: 12px;
            margin-top: 5px;
            opacity: 0.9;
        }

        /* ==================== TABLES ==================== */
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        .analytics-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .analytics-table thead {
            background-color: var(--light-bg);
        }

        .analytics-table th {
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: var(--text-color);
            border-bottom: 2px solid var(--border-color);
            cursor: pointer;
            user-select: none;
        }

        .analytics-table th:hover {
            background-color: var(--border-color);
        }

        .analytics-table td {
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .analytics-table tbody tr:hover {
            background-color: var(--light-bg);
        }

        .trend-up {
            color: var(--success-color);
            font-weight: 600;
        }

        .trend-down {
            color: var(--danger-color);
            font-weight: 600;
        }

        /* ==================== PAGINATION ==================== */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 5px;
            margin-top: 20px;
        }

        .pagination button {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            background-color: var(--white);
            color: var(--text-color);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination button:hover {
            background-color: var(--secondary-color);
            color: var(--white);
            border-color: var(--secondary-color);
        }

        .pagination button.active {
            background-color: var(--secondary-color);
            color: var(--white);
            border-color: var(--secondary-color);
        }

        /* ==================== EXPORT OPTIONS ==================== */
        .export-panel {
            background-color: var(--light-bg);
            padding: 15px;
            border-radius: 6px;
            margin-top: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .export-panel label {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 13px;
        }

        .export-btn {
            padding: 8px 15px;
            background-color: var(--secondary-color);
            color: var(--white);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            background-color: #2980b9;
        }

        /* ==================== COMPARISON VIEW ==================== */
        .comparison-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .comparison-box {
            background-color: var(--light-bg);
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid var(--secondary-color);
        }

        .comparison-title {
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 13px;
            color: var(--text-color);
        }

        .comparison-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--secondary-color);
            margin-bottom: 5px;
        }

        .comparison-change {
            font-size: 12px;
            color: var(--light-text);
        }

        /* ==================== LOADING STATE ==================== */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            color: var(--light-text);
        }

        .spinner {
            border: 4px solid var(--light-bg);
            border-top: 4px solid var(--secondary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ==================== RESPONSIVE ==================== */
        @media (max-width: 768px) {
            .filter-grid {
                grid-template-columns: 1fr;
            }

            .two-column-charts {
                grid-template-columns: 1fr;
            }

            .comparison-container {
                grid-template-columns: 1fr;
            }

            .section-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .analytics-table {
                font-size: 12px;
            }

            .analytics-table th,
            .analytics-table td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar Navigation -->
        <aside class="admin-sidebar">
            <div class="sidebar-logo">
                <h1>ShoppingCart</h1>
                <p>Admin Panel</p>
            </div>
            <ul class="sidebar-menu">
                <li><a href="../admin/dashboard.html"><i class="fas fa-home"></i> Dashboard</a></li>
                <li><a href="../admin/analytics.html" class="active"><i class="fas fa-chart-line"></i> Analytics</a></li>
                
                <div class="section-title">Management</div>
                <li><a href="../admin/products.html"><i class="fas fa-box"></i> Products</a></li>
                <li><a href="../admin/categories.html"><i class="fas fa-list"></i> Categories</a></li>
                <li><a href="../admin/orders.html"><i class="fas fa-shopping-cart"></i> Orders</a></li>
                <li><a href="../admin/users.html"><i class="fas fa-users"></i> Users</a></li>
                <li><a href="../admin/inventory.html"><i class="fas fa-warehouse"></i> Inventory</a></li>
                
                <div class="section-title">Reports</div>
                <li><a href="../admin/reports.html"><i class="fas fa-file-pdf"></i> Reports</a></li>
                <li><a href="../admin/reviews.html"><i class="fas fa-star"></i> Reviews</a></li>
                
                <div class="section-title">System</div>
                <li><a href="#"><i class="fas fa-cog"></i> Settings</a></li>
                <li><a href="#"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
            </ul>
        </aside>

        <!-- Main Content -->
        <div class="admin-main-wrapper">
            <!-- Header -->
            <header class="admin-header">
                <div class="header-left">
                    <div class="header-title">
                        <h1>Analytics Dashboard</h1>
                        <p>Comprehensive business intelligence and insights</p>
                    </div>
                </div>
                <div class="header-right">
                    <div class="header-search">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search...">
                    </div>
                    <div class="header-icons">
                        <div class="header-icon">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge">3</span>
                        </div>
                        <div class="header-icon">
                            <i class="fas fa-envelope"></i>
                        </div>
                    </div>
                    <div class="user-profile">
                        <div class="user-avatar">AD</div>
                        <div class="user-info">
                            <span class="name">Admin</span>
                            <span class="role">Administrator</span>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Analytics Content -->
            <main class="admin-content">
                <!-- Breadcrumb -->
                <div class="breadcrumb">
                    <a href="../admin/dashboard.html">Dashboard</a>
                    <i class="fas fa-chevron-right"></i>
                    <span>Analytics</span>
                </div>

                <!-- Filter Panel -->
                <div class="filter-panel">
                    <h3><i class="fas fa-filter"></i> Analytics Filters</h3>
                    <div class="filter-grid">
                        <div class="filter-group">
                            <label for="dateFrom">Start Date</label>
                            <input type="date" id="dateFrom">
                        </div>
                        <div class="filter-group">
                            <label for="dateTo">End Date</label>
                            <input type="date" id="dateTo">
                        </div>
                        <div class="filter-group">
                            <label for="period">Time Period</label>
                            <select id="period">
                                <option value="daily">Daily</option>
                                <option value="weekly">Weekly</option>
                                <option value="monthly" selected>Monthly</option>
                                <option value="yearly">Yearly</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="category">Product Category</label>
                            <select id="category">
                                <option value="">All Categories</option>
                                <option value="electronics">Electronics</option>
                                <option value="clothing">Clothing</option>
                                <option value="food">Food & Beverages</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="paymentMethod">Payment Method</label>
                            <select id="paymentMethod">
                                <option value="">All Methods</option>
                                <option value="card">Credit/Debit Card</option>
                                <option value="wallet">Digital Wallet</option>
                                <option value="cod">Cash on Delivery</option>
                                <option value="upi">UPI</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="region">Region</label>
                            <select id="region">
                                <option value="">All Regions</option>
                                <option value="north">North</option>
                                <option value="south">South</option>
                                <option value="east">East</option>
                                <option value="west">West</option>
                            </select>
                        </div>
                    </div>
                    <div class="filter-buttons">
                        <button class="btn-apply" onclick="applyFilters()">
                            <i class="fas fa-check"></i> Apply Filters
                        </button>
                        <button class="btn-reset" onclick="resetFilters()">
                            <i class="fas fa-redo"></i> Reset
                        </button>
                    </div>
                </div>

                <!-- Revenue Analytics Section -->
                <div class="analytics-section">
                    <div class="section-header">
                        <h3><i class="fas fa-dollar-sign"></i> Revenue Analytics</h3>
                        <div class="section-actions">
                            <button onclick="downloadChart('revenue')"><i class="fas fa-download"></i> Download</button>
                            <button onclick="toggleChart('revenue')"><i class="fas fa-expand"></i> Expand</button>
                        </div>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-label">Total Revenue</div>
                            <div class="stat-value" id="totalRevenue">$125,450</div>
                            <div class="stat-change"><i class="fas fa-arrow-up"></i> +12.5%</div>
                        </div>
                        <div class="stat-box success">
                            <div class="stat-label">Gross Profit</div>
                            <div class="stat-value" id="grossProfit">$45,230</div>
                            <div class="stat-change"><i class="fas fa-arrow-up"></i> +8.3%</div>
                        </div>
                        <div class="stat-box warning">
                            <div class="stat-label">Avg Order Value</div>
                            <div class="stat-value" id="avgOrderValue">$356.80</div>
                            <div class="stat-change"><i class="fas fa-arrow-down"></i> -2.1%</div>
                        </div>
                        <div class="stat-box danger">
                            <div class="stat-label">Total Refunds</div>
                            <div class="stat-value" id="totalRefunds">$8,920</div>
                            <div class="stat-change">5 orders refunded</div>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>

                <!-- Product & Customer Analytics -->
                <div class="two-column-charts">
                    <!-- Product Analytics -->
                    <div class="analytics-section">
                        <div class="section-header">
                            <h3><i class="fas fa-shopping-bag"></i> Product Analytics</h3>
                            <div class="section-actions">
                                <button onclick="downloadChart('products')"><i class="fas fa-download"></i> Download</button>
                            </div>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-box success">
                                <div class="stat-label">Best Seller</div>
                                <div class="stat-value">1,245</div>
                                <div class="stat-change">Laptop Model X</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-label">Worst Performer</div>
                                <div class="stat-value">12</div>
                                <div class="stat-change">USB Cable 2m</div>
                            </div>
                        </div>
                        <div class="chart-box">
                            <canvas id="productChart"></canvas>
                        </div>
                    </div>

                    <!-- Customer Analytics -->
                    <div class="analytics-section">
                        <div class="section-header">
                            <h3><i class="fas fa-users"></i> Customer Analytics</h3>
                            <div class="section-actions">
                                <button onclick="downloadChart('customers')"><i class="fas fa-download"></i> Download</button>
                            </div>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-box success">
                                <div class="stat-label">New Customers</div>
                                <div class="stat-value">342</div>
                                <div class="stat-change"><i class="fas fa-arrow-up"></i> +25%</div>
                            </div>
                            <div class="stat-box warning">
                                <div class="stat-label">Retention Rate</div>
                                <div class="stat-value">68.5%</div>
                                <div class="stat-change">This Month</div>
                            </div>
                        </div>
                        <div class="chart-box">
                            <canvas id="customerChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Payment & Order Analytics -->
                <div class="two-column-charts">
                    <!-- Payment Analytics -->
                    <div class="analytics-section">
                        <div class="section-header">
                            <h3><i class="fas fa-credit-card"></i> Payment Analytics</h3>
                            <div class="section-actions">
                                <button onclick="downloadChart('payment')"><i class="fas fa-download"></i> Download</button>
                            </div>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-box success">
                                <div class="stat-label">Success Rate</div>
                                <div class="stat-value">98.7%</div>
                                <div class="stat-change">2,456 successful</div>
                            </div>
                            <div class="stat-box danger">
                                <div class="stat-label">Failed Payments</div>
                                <div class="stat-value">32</div>
                                <div class="stat-change">Avg: $425</div>
                            </div>
                        </div>
                        <div class="chart-box">
                            <canvas id="paymentChart"></canvas>
                        </div>
                    </div>

                    <!-- Order Analytics -->
                    <div class="analytics-section">
                        <div class="section-header">
                            <h3><i class="fas fa-box"></i> Order Analytics</h3>
                            <div class="section-actions">
                                <button onclick="downloadChart('orders')"><i class="fas fa-download"></i> Download</button>
                            </div>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-box">
                                <div class="stat-label">Total Orders</div>
                                <div class="stat-value">2,488</div>
                                <div class="stat-change"><i class="fas fa-arrow-up"></i> +18%</div>
                            </div>
                            <div class="stat-box success">
                                <div class="stat-label">Fulfillment Rate</div>
                                <div class="stat-value">96.4%</div>
                                <div class="stat-change">2,396 shipped</div>
                            </div>
                        </div>
                        <div class="chart-box">
                            <canvas id="orderChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Top Products Table -->
                <div class="analytics-section">
                    <div class="section-header">
                        <h3><i class="fas fa-crown"></i> Top 10 Products</h3>
                        <div class="section-actions">
                            <button onclick="exportTable('products')"><i class="fas fa-file-csv"></i> Export</button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="analytics-table">
                            <thead>
                                <tr>
                                    <th onclick="sortTable('products', 0)">Rank <i class="fas fa-sort"></i></th>
                                    <th onclick="sortTable('products', 1)">Product Name <i class="fas fa-sort"></i></th>
                                    <th onclick="sortTable('products', 2)">Units Sold <i class="fas fa-sort"></i></th>
                                    <th onclick="sortTable('products', 3)">Revenue <i class="fas fa-sort"></i></th>
                                    <th onclick="sortTable('products', 4)">Profit <i class="fas fa-sort"></i></th>
                                    <th onclick="sortTable('products', 5)">Margin <i class="fas fa-sort"></i></th>
                                    <th>Rating</th>
                                </tr>
                            </thead>
                            <tbody id="topProductsTable">
                                <tr>
                                    <td>1</td>
                                    <td>Laptop Pro 15</td>
                                    <td>1,245</td>
                                    <td>$87,150</td>
                                    <td>$31,500</td>
                                    <td class="trend-up">36.1%</td>
                                    <td><i class="fas fa-star" style="color: #f39c12;"></i> 4.8/5</td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>Wireless Mouse</td>
                                    <td>3,456</td>
                                    <td>$34,560</td>
                                    <td>$10,368</td>
                                    <td class="trend-up">30%</td>
                                    <td><i class="fas fa-star" style="color: #f39c12;"></i> 4.6/5</td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>USB-C Hub</td>
                                    <td>2,891</td>
                                    <td>$28,910</td>
                                    <td>$8,673</td>
                                    <td class="trend-up">30%</td>
                                    <td><i class="fas fa-star" style="color: #f39c12;"></i> 4.5/5</td>
                                </tr>
                                <tr>
                                    <td>4</td>
                                    <td>Mechanical Keyboard</td>
                                    <td>2,145</td>
                                    <td>$25,740</td>
                                    <td>$7,722</td>
                                    <td class="trend-up">30%</td>
                                    <td><i class="fas fa-star" style="color: #f39c12;"></i> 4.9/5</td>
                                </tr>
                                <tr>
                                    <td>5</td>
                                    <td>Monitor 4K 27</td>
                                    <td>1,876</td>
                                    <td>$22,512</td>
                                    <td>$6,754</td>
                                    <td class="trend-up">30%</td>
                                    <td><i class="fas fa-star" style="color: #f39c12;"></i> 4.7/5</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Comparison View -->
                <div class="analytics-section">
                    <div class="section-header">
                        <h3><i class="fas fa-chart-bar"></i> Period Comparison</h3>
                    </div>
                    <div class="comparison-container">
                        <div class="comparison-box" style="border-left-color: var(--secondary-color);">
                            <div class="comparison-title">Current Period</div>
                            <div class="comparison-value">$125,450</div>
                            <div class="comparison-change">Oct 1 - Oct 31, 2024</div>
                        </div>
                        <div class="comparison-box" style="border-left-color: var(--success-color);">
                            <div class="comparison-title">Previous Period</div>
                            <div class="comparison-value">$111,200</div>
                            <div class="comparison-change">Sep 1 - Sep 30, 2024</div>
                        </div>
                        <div class="comparison-box" style="border-left-color: var(--warning-color);">
                            <div class="comparison-title">Difference</div>
                            <div class="comparison-value" class="trend-up">+$14,250</div>
                            <div class="comparison-change">+12.8% Growth</div>
                        </div>
                        <div class="comparison-box" style="border-left-color: var(--danger-color);">
                            <div class="comparison-title">Year on Year</div>
                            <div class="comparison-value">+42.3%</div>
                            <div class="comparison-change">Oct 2023 vs Oct 2024</div>
                        </div>
                    </div>
                </div>

                <!-- Export Panel -->
                <div class="analytics-section">
                    <div class="section-header">
                        <h3><i class="fas fa-download"></i> Export & Reports</h3>
                    </div>
                    <div class="export-panel">
                        <label style="flex: 1;">Select export format and download all analytics data:</label>
                        <button class="export-btn" onclick="exportData('pdf')"><i class="fas fa-file-pdf"></i> PDF</button>
                        <button class="export-btn" onclick="exportData('excel')"><i class="fas fa-file-excel"></i> Excel</button>
                        <button class="export-btn" onclick="exportData('csv')"><i class="fas fa-file-csv"></i> CSV</button>
                        <button class="export-btn" onclick="scheduleReport()"><i class="fas fa-clock"></i> Schedule Report</button>
                        <button class="export-btn" onclick="emailReport()"><i class="fas fa-envelope"></i> Email Report</button>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Scripts -->
    <script src="../../js/admin-api.js"></script>
    <script src="../../js/admin-analytics.js"></script>
</body>
</html>
